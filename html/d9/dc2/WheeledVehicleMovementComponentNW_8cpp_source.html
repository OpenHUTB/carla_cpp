<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CARLA: WheeledVehicleMovementComponentNW.cpp 源文件</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CARLA
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="搜索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">载入中...</div>
<div class="SRStatus" id="Searching">搜索中...</div>
<div class="SRStatus" id="NoMatches">未找到</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_2d15d0715a2692171bd03ed14a4a79af.html">Unreal</a></li><li class="navelem"><a class="el" href="../../dir_d3c1db2570616bec48bf5a6dd06bce95.html">CarlaUE4</a></li><li class="navelem"><a class="el" href="../../dir_3538576148ac14151677be9b0aee6fcc.html">Plugins</a></li><li class="navelem"><a class="el" href="../../dir_fbda5b12374c683cbdca72abb2d51944.html">Carla</a></li><li class="navelem"><a class="el" href="../../dir_18937e8f6bde63367bf26837323a9508.html">Source</a></li><li class="navelem"><a class="el" href="../../dir_8fc34afb5f07a67966c78bf5319f94ae.html">Carla</a></li><li class="navelem"><a class="el" href="../../dir_4d620431c9b0dc62fca23e1ed91a49b6.html">Vehicle</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="headertitle"><div class="title">WheeledVehicleMovementComponentNW.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html">浏览该文件的文档.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// Copyright (c) 2022 Computer Vision Center (CVC) at the Universitat Autonoma</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">// de Barcelona (UAB).</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">//</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">// This work is licensed under the terms of the MIT license.</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">// For a copy, see &lt;https://opensource.org/licenses/MIT&gt;.</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span> </div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#include &quot;<a class="code" href="../../d0/d34/WheeledVehicleMovementComponentNW_8h.html">WheeledVehicleMovementComponentNW.h</a>&quot;</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#include &quot;PhysicsPublic.h&quot;</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &quot;PhysXPublic.h&quot;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#include &quot;PhysXVehicleManager.h&quot;</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &quot;Components/PrimitiveComponent.h&quot;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &quot;Logging/MessageLog.h&quot;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span> </div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span>UWheeledVehicleMovementComponentNW::UWheeledVehicleMovementComponentNW(<span class="keyword">const</span> FObjectInitializer&amp; ObjectInitializer) : Super(ObjectInitializer)</div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span>{</div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span>    <span class="comment">// grab default values from physx</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span>    PxVehicleEngineData DefEngineData;</div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span>    EngineSetup.MOI = DefEngineData.mMOI;</div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span>    EngineSetup.MaxRPM = OmegaToRPM(DefEngineData.mMaxOmega);</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>    EngineSetup.DampingRateFullThrottle = DefEngineData.mDampingRateFullThrottle;</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span>    EngineSetup.DampingRateZeroThrottleClutchEngaged = DefEngineData.mDampingRateZeroThrottleClutchEngaged;</div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>    EngineSetup.DampingRateZeroThrottleClutchDisengaged = DefEngineData.mDampingRateZeroThrottleClutchDisengaged;</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span>    <span class="comment">// Convert from PhysX curve to ours</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>    FRichCurve* TorqueCurveData = EngineSetup.TorqueCurve.GetRichCurve();</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>    <span class="keywordflow">for</span> (PxU32 KeyIdx = 0; KeyIdx &lt; DefEngineData.mTorqueCurve.getNbDataPairs(); ++KeyIdx)</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>    {</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>        <span class="keywordtype">float</span> Input = DefEngineData.mTorqueCurve.getX(KeyIdx) * EngineSetup.MaxRPM;</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>        <span class="keywordtype">float</span> Output = DefEngineData.mTorqueCurve.getY(KeyIdx) * DefEngineData.mPeakTorque;</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>        TorqueCurveData-&gt;AddKey(Input, Output);</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>    }</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span> </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>    PxVehicleClutchData DefClutchData;</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>    TransmissionSetup.ClutchStrength = DefClutchData.mStrength;</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span> </div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>    PxVehicleGearsData DefGearSetup;</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>    TransmissionSetup.GearSwitchTime = DefGearSetup.mSwitchTime;</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>    TransmissionSetup.ReverseGearRatio = DefGearSetup.mRatios[PxVehicleGearsData::eREVERSE];</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>    TransmissionSetup.FinalRatio = DefGearSetup.mFinalRatio;</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span> </div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>    PxVehicleAutoBoxData DefAutoBoxSetup;</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>    TransmissionSetup.NeutralGearUpRatio = DefAutoBoxSetup.mUpRatios[PxVehicleGearsData::eNEUTRAL];</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>    TransmissionSetup.GearAutoBoxLatency = DefAutoBoxSetup.getLatency();</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>    TransmissionSetup.bUseGearAutoBox = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span> </div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>    <span class="keywordflow">for</span> (uint32 i = PxVehicleGearsData::eFIRST; i &lt; DefGearSetup.mNbRatios; ++i)</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    {</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>        <a class="code hl_struct" href="../../da/d31/structFVehicleNWGearData.html">FVehicleNWGearData</a> GearData;</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>        GearData.<a class="code hl_variable" href="../../da/d31/structFVehicleNWGearData.html#adf09baf55006d7a9c3ea8f443f3eaf37">DownRatio</a> = DefAutoBoxSetup.mDownRatios[i];</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>        GearData.<a class="code hl_variable" href="../../da/d31/structFVehicleNWGearData.html#ae798c64d3cdbb31b6abfd6eec7a5ec09">UpRatio</a> = DefAutoBoxSetup.mUpRatios[i];</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>        GearData.<a class="code hl_variable" href="../../da/d31/structFVehicleNWGearData.html#a8f37e78f733f2dcc6cc15d6c69913d00">Ratio</a> = DefGearSetup.mRatios[i];</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>        TransmissionSetup.ForwardGears.Add(GearData);</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>    }</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span> </div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>    <span class="comment">// Init steering speed curve</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>    FRichCurve* SteeringCurveData = SteeringCurve.GetRichCurve();</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>    SteeringCurveData-&gt;AddKey(0.0f, 1.0f);</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>    SteeringCurveData-&gt;AddKey(20.0f, 0.9f);</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    SteeringCurveData-&gt;AddKey(60.0f, 0.8f);</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    SteeringCurveData-&gt;AddKey(120.0f, 0.7f);</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span> </div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>    <span class="comment">// Initialize WheelSetups array with 4 wheels, this can be modified via editor later</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    <span class="keyword">const</span> int32 NbrWheels = 4;</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>    WheelSetups.SetNum(NbrWheels);</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>    DifferentialSetup.SetNum(NbrWheels);</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span> </div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    IdleBrakeInput = 10;</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>}</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span> </div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span><span class="preprocessor">#if WITH_EDITOR</span></div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span><span class="keywordtype">void</span> UWheeledVehicleMovementComponentNW::PostEditChangeProperty(<span class="keyword">struct</span> FPropertyChangedEvent&amp; PropertyChangedEvent)</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>{</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>    Super::PostEditChangeProperty(PropertyChangedEvent);</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>    <span class="keyword">const</span> FName PropertyName = PropertyChangedEvent.Property ? PropertyChangedEvent.Property-&gt;GetFName() : NAME_None;</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span> </div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>    <span class="keywordflow">if</span> (PropertyName == TEXT(<span class="stringliteral">&quot;DownRatio&quot;</span>))</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>    {</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>        <span class="keywordflow">for</span> (int32 GearIdx = 0; GearIdx &lt; TransmissionSetup.ForwardGears.Num(); ++GearIdx)</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>        {</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>            <a class="code hl_struct" href="../../da/d31/structFVehicleNWGearData.html">FVehicleNWGearData</a>&amp; GearData = TransmissionSetup.ForwardGears[GearIdx];</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>            GearData.<a class="code hl_variable" href="../../da/d31/structFVehicleNWGearData.html#adf09baf55006d7a9c3ea8f443f3eaf37">DownRatio</a> = FMath::Min(GearData.<a class="code hl_variable" href="../../da/d31/structFVehicleNWGearData.html#adf09baf55006d7a9c3ea8f443f3eaf37">DownRatio</a>, GearData.<a class="code hl_variable" href="../../da/d31/structFVehicleNWGearData.html#ae798c64d3cdbb31b6abfd6eec7a5ec09">UpRatio</a>);</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>        }</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>    }</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PropertyName == TEXT(<span class="stringliteral">&quot;UpRatio&quot;</span>))</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    {</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>        <span class="keywordflow">for</span> (int32 GearIdx = 0; GearIdx &lt; TransmissionSetup.ForwardGears.Num(); ++GearIdx)</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>        {</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>            <a class="code hl_struct" href="../../da/d31/structFVehicleNWGearData.html">FVehicleNWGearData</a>&amp; GearData = TransmissionSetup.ForwardGears[GearIdx];</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>            GearData.<a class="code hl_variable" href="../../da/d31/structFVehicleNWGearData.html#ae798c64d3cdbb31b6abfd6eec7a5ec09">UpRatio</a> = FMath::Max(GearData.<a class="code hl_variable" href="../../da/d31/structFVehicleNWGearData.html#adf09baf55006d7a9c3ea8f443f3eaf37">DownRatio</a>, GearData.<a class="code hl_variable" href="../../da/d31/structFVehicleNWGearData.html#ae798c64d3cdbb31b6abfd6eec7a5ec09">UpRatio</a>);</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>        }</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>    }</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PropertyName == TEXT(<span class="stringliteral">&quot;SteeringCurve&quot;</span>))</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>    {</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>        <span class="comment">//make sure values are capped between 0 and 1</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>        TArray&lt;FRichCurveKey&gt; SteerKeys = SteeringCurve.GetRichCurve()-&gt;GetCopyOfKeys();</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>        <span class="keywordflow">for</span> (int32 KeyIdx = 0; KeyIdx &lt; SteerKeys.Num(); ++KeyIdx)</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>        {</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>            <span class="keywordtype">float</span> NewValue = FMath::Clamp(SteerKeys[KeyIdx].Value, 0.0f, 1.0f);</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>            SteeringCurve.GetRichCurve()-&gt;UpdateOrAddKey(SteerKeys[KeyIdx].Time, NewValue);</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>        }</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>    }</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>}</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span> </div>
<div class="foldopen" id="foldopen00105" data-start="{" data-end="}">
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno"><a class="line" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#ac806da6b225b0d47ea8ddb7610cc8e70">  105</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#ac806da6b225b0d47ea8ddb7610cc8e70">GetVehicleDifferentialNWSetup</a>(<span class="keyword">const</span> TArray&lt;FVehicleNWWheelDifferentialData&gt;&amp; Setup, PxVehicleDifferentialNWData&amp; PxSetup)</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>{</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>    <span class="keywordflow">for</span> (int32 i = 0; i &lt; Setup.Num(); ++i)</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>    {</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>        PxSetup.setDrivenWheel(i, Setup[i].bDriven);</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>    }</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>}</div>
</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span> </div>
<div class="foldopen" id="foldopen00113" data-start="{" data-end="}">
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno"><a class="line" href="../../de/de4/structFVehicleNWEngineData.html#a981f29b1e71c72f980d0335e2fbc5bbd">  113</a></span><span class="keywordtype">float</span> <a class="code hl_function" href="../../de/de4/structFVehicleNWEngineData.html#a981f29b1e71c72f980d0335e2fbc5bbd">FVehicleNWEngineData::FindPeakTorque</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>    <span class="comment">// Find max torque</span></div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>    <span class="keywordtype">float</span> PeakTorque = 0.0f;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>    TArray&lt;FRichCurveKey&gt; TorqueKeys = <a class="code hl_variable" href="../../de/de4/structFVehicleNWEngineData.html#ad5c4408177a986dd6a1605ba2aea7fb9">TorqueCurve</a>.GetRichCurveConst()-&gt;GetCopyOfKeys();</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>    <span class="keywordflow">for</span> (int32 KeyIdx = 0; KeyIdx &lt; TorqueKeys.Num(); ++KeyIdx)</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>    {</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>        FRichCurveKey&amp; Key = TorqueKeys[KeyIdx];</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>        PeakTorque = FMath::Max(PeakTorque, Key.Value);</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>    }</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>    <span class="keywordflow">return</span> PeakTorque;</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>}</div>
</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span> </div>
<div class="foldopen" id="foldopen00126" data-start="{" data-end="}">
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno"><a class="line" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#a713e74572096e40d4c11118f0c3055bb">  126</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#a713e74572096e40d4c11118f0c3055bb">GetVehicleEngineSetup</a>(<span class="keyword">const</span> <a class="code hl_struct" href="../../de/de4/structFVehicleNWEngineData.html">FVehicleNWEngineData</a>&amp; Setup, PxVehicleEngineData&amp; PxSetup)</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>{</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    PxSetup.mMOI = M2ToCm2(Setup.<a class="code hl_variable" href="../../de/de4/structFVehicleNWEngineData.html#a7c7af0a90372f79d969508259f13f724">MOI</a>);</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>    PxSetup.mMaxOmega = RPMToOmega(Setup.<a class="code hl_variable" href="../../de/de4/structFVehicleNWEngineData.html#a8662b0e878291ce55baee2f4a6da92e7">MaxRPM</a>);</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>    PxSetup.mDampingRateFullThrottle = M2ToCm2(Setup.<a class="code hl_variable" href="../../de/de4/structFVehicleNWEngineData.html#a8e4fc31f2d055a3b85fdf85e1cbde95c">DampingRateFullThrottle</a>);</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    PxSetup.mDampingRateZeroThrottleClutchEngaged = M2ToCm2(Setup.<a class="code hl_variable" href="../../de/de4/structFVehicleNWEngineData.html#ac22e7a52dce155b745efb48759a18225">DampingRateZeroThrottleClutchEngaged</a>);</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>    PxSetup.mDampingRateZeroThrottleClutchDisengaged = M2ToCm2(Setup.<a class="code hl_variable" href="../../de/de4/structFVehicleNWEngineData.html#af3c6e9da67d8cfed1e478f2636fe9eaf">DampingRateZeroThrottleClutchDisengaged</a>);</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span> </div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>    <span class="keywordtype">float</span> PeakTorque = Setup.<a class="code hl_function" href="../../de/de4/structFVehicleNWEngineData.html#a981f29b1e71c72f980d0335e2fbc5bbd">FindPeakTorque</a>(); <span class="comment">// In Nm</span></div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    PxSetup.mPeakTorque = M2ToCm2(PeakTorque);  <span class="comment">// convert Nm to (kg cm^2/s^2)</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span> </div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>    <span class="comment">// Convert from our curve to PhysX</span></div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>    PxSetup.mTorqueCurve.clear();</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    TArray&lt;FRichCurveKey&gt; TorqueKeys = Setup.<a class="code hl_variable" href="../../de/de4/structFVehicleNWEngineData.html#ad5c4408177a986dd6a1605ba2aea7fb9">TorqueCurve</a>.GetRichCurveConst()-&gt;GetCopyOfKeys();</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    int32 NumTorqueCurveKeys = FMath::Min&lt;int32&gt;(TorqueKeys.Num(), PxVehicleEngineData::eMAX_NB_ENGINE_TORQUE_CURVE_ENTRIES);</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    <span class="keywordflow">for</span> (int32 KeyIdx = 0; KeyIdx &lt; NumTorqueCurveKeys; ++KeyIdx)</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    {</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>        FRichCurveKey&amp; Key = TorqueKeys[KeyIdx];</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>        PxSetup.mTorqueCurve.addPair(FMath::Clamp(Key.Time / Setup.<a class="code hl_variable" href="../../de/de4/structFVehicleNWEngineData.html#a8662b0e878291ce55baee2f4a6da92e7">MaxRPM</a>, 0.0f, 1.0f), Key.Value / PeakTorque); <span class="comment">// Normalize torque to 0-1 range</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>    }</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>}</div>
</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span> </div>
<div class="foldopen" id="foldopen00148" data-start="{" data-end="}">
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno"><a class="line" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#aa5d2b4417d4ad88098bb74ea75b54500">  148</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#aa5d2b4417d4ad88098bb74ea75b54500">GetVehicleGearSetup</a>(<span class="keyword">const</span> <a class="code hl_struct" href="../../db/da1/structFVehicleNWTransmissionData.html">FVehicleNWTransmissionData</a>&amp; Setup, PxVehicleGearsData&amp; PxSetup)</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>{</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>    PxSetup.mSwitchTime = Setup.<a class="code hl_variable" href="../../db/da1/structFVehicleNWTransmissionData.html#a6b5ef510999369811c66884722607219">GearSwitchTime</a>;</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    PxSetup.mRatios[PxVehicleGearsData::eREVERSE] = Setup.<a class="code hl_variable" href="../../db/da1/structFVehicleNWTransmissionData.html#abcd32b3eaa77483cea6bf95409a71dfe">ReverseGearRatio</a>;</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>    <span class="keywordflow">for</span> (int32 i = 0; i &lt; Setup.<a class="code hl_variable" href="../../db/da1/structFVehicleNWTransmissionData.html#aa89d362eb1e7224dc05b7928ab651135">ForwardGears</a>.Num(); i++)</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    {</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>        PxSetup.mRatios[i + PxVehicleGearsData::eFIRST] = Setup.<a class="code hl_variable" href="../../db/da1/structFVehicleNWTransmissionData.html#aa89d362eb1e7224dc05b7928ab651135">ForwardGears</a>[i].Ratio;</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>    }</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    PxSetup.mFinalRatio = Setup.<a class="code hl_variable" href="../../db/da1/structFVehicleNWTransmissionData.html#a9fe0561f1af34b0ea9ea56ae7f272561">FinalRatio</a>;</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>    PxSetup.mNbRatios = Setup.<a class="code hl_variable" href="../../db/da1/structFVehicleNWTransmissionData.html#aa89d362eb1e7224dc05b7928ab651135">ForwardGears</a>.Num() + PxVehicleGearsData::eFIRST;</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>}</div>
</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span> </div>
<div class="foldopen" id="foldopen00160" data-start="{" data-end="}">
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno"><a class="line" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#acffce682bc9ea728ec7e2c2fd2603543">  160</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#acffce682bc9ea728ec7e2c2fd2603543">GetVehicleAutoBoxSetup</a>(<span class="keyword">const</span> <a class="code hl_struct" href="../../db/da1/structFVehicleNWTransmissionData.html">FVehicleNWTransmissionData</a>&amp; Setup, PxVehicleAutoBoxData&amp; PxSetup)</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>{</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>    <span class="keywordflow">for</span> (int32 i = 0; i &lt; Setup.<a class="code hl_variable" href="../../db/da1/structFVehicleNWTransmissionData.html#aa89d362eb1e7224dc05b7928ab651135">ForwardGears</a>.Num(); ++i)</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    {</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>        <span class="keyword">const</span> <a class="code hl_struct" href="../../da/d31/structFVehicleNWGearData.html">FVehicleNWGearData</a>&amp; GearData = Setup.<a class="code hl_variable" href="../../db/da1/structFVehicleNWTransmissionData.html#aa89d362eb1e7224dc05b7928ab651135">ForwardGears</a>[i];</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>        PxSetup.mUpRatios[i + PxVehicleGearsData::eFIRST] = GearData.<a class="code hl_variable" href="../../da/d31/structFVehicleNWGearData.html#ae798c64d3cdbb31b6abfd6eec7a5ec09">UpRatio</a>;</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>        PxSetup.mDownRatios[i + PxVehicleGearsData::eFIRST] = GearData.<a class="code hl_variable" href="../../da/d31/structFVehicleNWGearData.html#adf09baf55006d7a9c3ea8f443f3eaf37">DownRatio</a>;</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>    }</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>    PxSetup.mUpRatios[PxVehicleGearsData::eNEUTRAL] = Setup.<a class="code hl_variable" href="../../db/da1/structFVehicleNWTransmissionData.html#a5f17a7c9ed7f686d4d19f36e0a31909a">NeutralGearUpRatio</a>;</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>    PxSetup.setLatency(Setup.<a class="code hl_variable" href="../../db/da1/structFVehicleNWTransmissionData.html#abe4054c6ca37cf25257886c208de5504">GearAutoBoxLatency</a>);</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span> </div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>}</div>
</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span> </div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>int32 UWheeledVehicleMovementComponentNW::GetCustomGearBoxNumForwardGears()<span class="keyword"> const</span></div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>    <span class="keywordflow">return</span> TransmissionSetup.ForwardGears.Num();</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>}</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span> </div>
<div class="foldopen" id="foldopen00178" data-start="{" data-end="}">
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno"><a class="line" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#ac33b402e532a6f4d536e8675cfc56b09">  178</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#ac33b402e532a6f4d536e8675cfc56b09">SetupDriveHelper</a>(<span class="keyword">const</span> UWheeledVehicleMovementComponentNW* VehicleData, <span class="keyword">const</span> PxVehicleWheelsSimData* PWheelsSimData, PxVehicleDriveSimDataNW&amp; DriveData)</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>{</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>    PxVehicleDifferentialNWData DifferentialSetup;</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    <a class="code hl_function" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#ac806da6b225b0d47ea8ddb7610cc8e70">GetVehicleDifferentialNWSetup</a>(VehicleData-&gt;DifferentialSetup, DifferentialSetup);</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span> </div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>    DriveData.setDiffData(DifferentialSetup);</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span> </div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    PxVehicleEngineData EngineSetup;</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    <a class="code hl_function" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#a713e74572096e40d4c11118f0c3055bb">GetVehicleEngineSetup</a>(VehicleData-&gt;EngineSetup, EngineSetup);</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    DriveData.setEngineData(EngineSetup);</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span> </div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>    PxVehicleClutchData ClutchSetup;</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    ClutchSetup.mStrength = M2ToCm2(VehicleData-&gt;TransmissionSetup.ClutchStrength);</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>    DriveData.setClutchData(ClutchSetup);</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span> </div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>    PxVehicleGearsData GearSetup;</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    <a class="code hl_function" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#aa5d2b4417d4ad88098bb74ea75b54500">GetVehicleGearSetup</a>(VehicleData-&gt;TransmissionSetup, GearSetup);</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>    DriveData.setGearsData(GearSetup);</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span> </div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>    PxVehicleAutoBoxData AutoBoxSetup;</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    <a class="code hl_function" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#acffce682bc9ea728ec7e2c2fd2603543">GetVehicleAutoBoxSetup</a>(VehicleData-&gt;TransmissionSetup, AutoBoxSetup);</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    DriveData.setAutoBoxData(AutoBoxSetup);</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>}</div>
</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span> </div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span><span class="keywordtype">void</span> UWheeledVehicleMovementComponentNW::SetupVehicle()</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>{</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>    <span class="keywordflow">if</span> (!UpdatedPrimitive)</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    {</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>    }</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span> </div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>    <span class="keywordflow">if</span> (WheelSetups.Num() &lt; 2)</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>    {</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>        PVehicle = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>        PVehicleDrive = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>    }</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span> </div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>    <span class="keywordflow">for</span> (int32 WheelIdx = 0; WheelIdx &lt; WheelSetups.Num(); ++WheelIdx)</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>    {</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>        <span class="keyword">const</span> FWheelSetup&amp; WheelSetup = WheelSetups[WheelIdx];</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>        <span class="keywordflow">if</span> (WheelSetup.BoneName == NAME_None)</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>        {</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>        }</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    }</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span> </div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    <span class="comment">// Setup the chassis and wheel shapes</span></div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    SetupVehicleShapes();</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span> </div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>    <span class="comment">// Setup mass properties</span></div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    SetupVehicleMass();</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span> </div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>    <span class="comment">// Setup the wheels</span></div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>    PxVehicleWheelsSimData* PWheelsSimData = PxVehicleWheelsSimData::allocate(WheelSetups.Num());</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    SetupWheels(PWheelsSimData);</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span> </div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>    <span class="comment">// Setup drive data</span></div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>    PxVehicleDriveSimDataNW DriveData;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>    <a class="code hl_function" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#ac33b402e532a6f4d536e8675cfc56b09">SetupDriveHelper</a>(<span class="keyword">this</span>, PWheelsSimData, DriveData);</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span> </div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    <span class="comment">// Create the vehicle</span></div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>    PxVehicleDriveNW* PVehicleDriveNW = PxVehicleDriveNW::allocate(WheelSetups.Num());</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    check(PVehicleDriveNW);</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span> </div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>    FBodyInstance* TargetInstance = UpdatedPrimitive-&gt;GetBodyInstance();</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span> </div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    FPhysicsCommand::ExecuteWrite(TargetInstance-&gt;ActorHandle, [&amp;](<span class="keyword">const</span> FPhysicsActorHandle&amp; Actor)</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>        {</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>            PxRigidActor* PActor = FPhysicsInterface::GetPxRigidActor_AssumesLocked(Actor);</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>            if (!PActor)</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>            {</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>                return;</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>            }</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span> </div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>            if (PxRigidDynamic* PVehicleActor = PActor-&gt;is&lt;PxRigidDynamic&gt;())</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>            {</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>                PVehicleDriveNW-&gt;setup(GPhysXSDK, PVehicleActor, *PWheelsSimData, DriveData, 0);</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>                PVehicleDriveNW-&gt;setToRestState();</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span> </div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>                <span class="comment">// cleanup</span></div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>                PWheelsSimData-&gt;free();</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>            }</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>        });</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span> </div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>    PWheelsSimData = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span> </div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>    <span class="comment">// cache values</span></div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>    PVehicle = PVehicleDriveNW;</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    PVehicleDrive = PVehicleDriveNW;</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span> </div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>    SetUseAutoGears(TransmissionSetup.bUseGearAutoBox);</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span> </div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>}</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span> </div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span><span class="keywordtype">void</span> UWheeledVehicleMovementComponentNW::UpdateSimulation(<span class="keywordtype">float</span> DeltaTime)</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>{</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>    <span class="keywordflow">if</span> (PVehicleDrive == <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span> </div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>    FBodyInstance* TargetInstance = UpdatedPrimitive-&gt;GetBodyInstance();</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span> </div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>    FPhysicsCommand::ExecuteWrite(TargetInstance-&gt;ActorHandle, [&amp;](<span class="keyword">const</span> FPhysicsActorHandle&amp; Actor)</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>    {</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>        PxVehicleDriveNWRawInputData RawInputData;</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>        RawInputData.setAnalogAccel(ThrottleInput);</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>        RawInputData.setAnalogSteer(SteeringInput);</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>        RawInputData.setAnalogBrake(BrakeInput);</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>        RawInputData.setAnalogHandbrake(HandbrakeInput);</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span> </div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>        if (!PVehicleDrive-&gt;mDriveDynData.getUseAutoGears())</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>        {</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>            RawInputData.setGearUp(bRawGearUpInput);</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>            RawInputData.setGearDown(bRawGearDownInput);</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>        }</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span> </div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>        <span class="comment">// Convert from our curve to PxFixedSizeLookupTable</span></div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>        PxFixedSizeLookupTable&lt;8&gt; SpeedSteerLookup;</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>        TArray&lt;FRichCurveKey&gt; SteerKeys = SteeringCurve.GetRichCurve()-&gt;GetCopyOfKeys();</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>        <span class="keyword">const</span> int32 MaxSteeringSamples = FMath::Min(8, SteerKeys.Num());</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>        for (int32 KeyIdx = 0; KeyIdx &lt; MaxSteeringSamples; KeyIdx++)</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>        {</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>            FRichCurveKey&amp; Key = SteerKeys[KeyIdx];</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>            SpeedSteerLookup.addPair(KmHToCmS(Key.Time), FMath::Clamp(Key.Value, 0.0f, 1.0f));</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>        }</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span> </div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>        PxVehiclePadSmoothingData SmoothData = {</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>            { ThrottleInputRate.RiseRate, BrakeInputRate.RiseRate, HandbrakeInputRate.RiseRate, SteeringInputRate.RiseRate, SteeringInputRate.RiseRate },</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>            { ThrottleInputRate.FallRate, BrakeInputRate.FallRate, HandbrakeInputRate.FallRate, SteeringInputRate.FallRate, SteeringInputRate.FallRate }</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>        };</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span> </div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>        PxVehicleDriveNW* PVehicleDriveNW = (PxVehicleDriveNW*)PVehicleDrive;</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>        PxVehicleDriveNWSmoothAnalogRawInputsAndSetAnalogInputs(SmoothData, SpeedSteerLookup, RawInputData, DeltaTime, <span class="keyword">false</span>, *PVehicleDriveNW);</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>    });</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>}</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span> </div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span><span class="keywordtype">void</span> UWheeledVehicleMovementComponentNW::UpdateEngineSetup(<span class="keyword">const</span> <a class="code hl_struct" href="../../de/de4/structFVehicleNWEngineData.html">FVehicleNWEngineData</a>&amp; NewEngineSetup)</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>{</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>    <span class="keywordflow">if</span> (PVehicleDrive)</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>    {</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>        PxVehicleEngineData EngineData;</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>        <a class="code hl_function" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#a713e74572096e40d4c11118f0c3055bb">GetVehicleEngineSetup</a>(NewEngineSetup, EngineData);</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span> </div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>        PxVehicleDriveNW* PVehicleDriveNW = (PxVehicleDriveNW*)PVehicleDrive;</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>        PVehicleDriveNW-&gt;mDriveSimData.setEngineData(EngineData);</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>    }</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>}</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span> </div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span><span class="keywordtype">void</span> UWheeledVehicleMovementComponentNW::UpdateDifferentialSetup(<span class="keyword">const</span> TArray&lt;FVehicleNWWheelDifferentialData&gt;&amp; NewDifferentialSetup)</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>{</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>    <span class="keywordflow">if</span> (PVehicleDrive)</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>    {</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>        PxVehicleDifferentialNWData DifferentialData;</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>        <a class="code hl_function" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#ac806da6b225b0d47ea8ddb7610cc8e70">GetVehicleDifferentialNWSetup</a>(NewDifferentialSetup, DifferentialData);</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span> </div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>        PxVehicleDriveNW* PVehicleDriveNW = (PxVehicleDriveNW*)PVehicleDrive;</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>        PVehicleDriveNW-&gt;mDriveSimData.setDiffData(DifferentialData);</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    }</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>}</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span> </div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span><span class="keywordtype">void</span> UWheeledVehicleMovementComponentNW::UpdateTransmissionSetup(<span class="keyword">const</span> <a class="code hl_struct" href="../../db/da1/structFVehicleNWTransmissionData.html">FVehicleNWTransmissionData</a>&amp; NewTransmissionSetup)</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>{</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>    <span class="keywordflow">if</span> (PVehicleDrive)</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>    {</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>        PxVehicleGearsData GearData;</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>        <a class="code hl_function" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#aa5d2b4417d4ad88098bb74ea75b54500">GetVehicleGearSetup</a>(NewTransmissionSetup, GearData);</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span> </div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>        PxVehicleAutoBoxData AutoBoxData;</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>        <a class="code hl_function" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#acffce682bc9ea728ec7e2c2fd2603543">GetVehicleAutoBoxSetup</a>(NewTransmissionSetup, AutoBoxData);</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span> </div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>        PxVehicleDriveNW* PVehicleDriveNW = (PxVehicleDriveNW*)PVehicleDrive;</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>        PVehicleDriveNW-&gt;mDriveSimData.setGearsData(GearData);</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>        PVehicleDriveNW-&gt;mDriveSimData.setAutoBoxData(AutoBoxData);</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>    }</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>}</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span> </div>
<div class="foldopen" id="foldopen00354" data-start="{" data-end="}">
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno"><a class="line" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#ab86c2f88f46c94457617779c19429cdb">  354</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#ab86c2f88f46c94457617779c19429cdb">BackwardsConvertCm2ToM2NW</a>(<span class="keywordtype">float</span>&amp; val, <span class="keywordtype">float</span> defaultValue)</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>{</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>    <span class="keywordflow">if</span> (val != defaultValue)</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>    {</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>        val = Cm2ToM2(val);</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>    }</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>}</div>
</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span> </div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span><span class="keywordtype">void</span> UWheeledVehicleMovementComponentNW::Serialize(FArchive&amp; Ar)</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>{</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>    Super::Serialize(Ar);</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>    <span class="keywordflow">if</span> (Ar.IsLoading() &amp;&amp; Ar.UE4Ver() &lt; VER_UE4_VEHICLES_UNIT_CHANGE)</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>    {</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>        PxVehicleEngineData DefEngineData;</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> DefaultRPM = OmegaToRPM(DefEngineData.mMaxOmega);</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span> </div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>        <span class="comment">// We need to convert from old units to new. This backwards compatible code fails in the rare case that they were using very strange values that are the new defaults in the correct units.</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>        EngineSetup.MaxRPM = EngineSetup.MaxRPM != DefaultRPM ? OmegaToRPM(EngineSetup.MaxRPM) : DefaultRPM;    <span class="comment">//need to convert from rad/s to RPM</span></div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>    }</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span> </div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>    <span class="keywordflow">if</span> (Ar.IsLoading() &amp;&amp; Ar.UE4Ver() &lt; VER_UE4_VEHICLES_UNIT_CHANGE2)</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>    {</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>        PxVehicleEngineData DefEngineData;</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>        PxVehicleClutchData DefClutchData;</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span> </div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>        <span class="comment">// We need to convert from old units to new. This backwards compatable code fails in the rare case that they were using very strange values that are the new defaults in the correct units.</span></div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>        <a class="code hl_function" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#ab86c2f88f46c94457617779c19429cdb">BackwardsConvertCm2ToM2NW</a>(EngineSetup.DampingRateFullThrottle, DefEngineData.mDampingRateFullThrottle);</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>        <a class="code hl_function" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#ab86c2f88f46c94457617779c19429cdb">BackwardsConvertCm2ToM2NW</a>(EngineSetup.DampingRateZeroThrottleClutchDisengaged, DefEngineData.mDampingRateZeroThrottleClutchDisengaged);</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>        <a class="code hl_function" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#ab86c2f88f46c94457617779c19429cdb">BackwardsConvertCm2ToM2NW</a>(EngineSetup.DampingRateZeroThrottleClutchEngaged, DefEngineData.mDampingRateZeroThrottleClutchEngaged);</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>        <a class="code hl_function" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#ab86c2f88f46c94457617779c19429cdb">BackwardsConvertCm2ToM2NW</a>(EngineSetup.MOI, DefEngineData.mMOI);</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>        <a class="code hl_function" href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#ab86c2f88f46c94457617779c19429cdb">BackwardsConvertCm2ToM2NW</a>(TransmissionSetup.ClutchStrength, DefClutchData.mStrength);</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>    }</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>}</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span> </div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span><span class="keywordtype">void</span> UWheeledVehicleMovementComponentNW::ComputeConstants()</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>{</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>    Super::ComputeConstants();</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>    MaxEngineRPM = EngineSetup.MaxRPM;</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>}</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span> </div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span><span class="keyword">const</span> <span class="keywordtype">void</span>* UWheeledVehicleMovementComponentNW::GetTireData(physx::PxVehicleWheels* InWheels, UVehicleWheel* InWheel)</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>{</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>    <span class="keyword">const</span> <span class="keywordtype">void</span>* realShaderData = &amp;InWheels-&gt;mWheelsSimData.getTireData((PxU32)InWheel-&gt;WheelIndex);</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>    <span class="keywordflow">return</span> realShaderData;</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>}</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span> </div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span><span class="keyword">const</span> int32 UWheeledVehicleMovementComponentNW::GetWheelShapeMapping(physx::PxVehicleWheels* InWheels, uint32 InWheel)</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>{</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>    <span class="keyword">const</span> physx::PxI32 ShapeIndex = InWheels-&gt;mWheelsSimData.getWheelShapeMapping((PxU32)InWheel);</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>    <span class="keywordflow">return</span> ShapeIndex;</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>}</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span> </div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span><span class="keyword">const</span> physx::PxVehicleWheelData UWheeledVehicleMovementComponentNW::GetWheelData(physx::PxVehicleWheels* InWheels, uint32 InWheel)</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>{</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>    <span class="keyword">const</span> physx::PxVehicleWheelData WheelData = InWheels-&gt;mWheelsSimData.getWheelData((physx::PxU32)InWheel);</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>    <span class="keywordflow">return</span> WheelData;</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>}</div>
<div class="ttc" id="aWheeledVehicleMovementComponentNW_8cpp_html_a713e74572096e40d4c11118f0c3055bb"><div class="ttname"><a href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#a713e74572096e40d4c11118f0c3055bb">GetVehicleEngineSetup</a></div><div class="ttdeci">static void GetVehicleEngineSetup(const FVehicleNWEngineData &amp;Setup, PxVehicleEngineData &amp;PxSetup)</div><div class="ttdef"><b>定义</b> <a href="#l00126">WheeledVehicleMovementComponentNW.cpp:126</a></div></div>
<div class="ttc" id="aWheeledVehicleMovementComponentNW_8cpp_html_aa5d2b4417d4ad88098bb74ea75b54500"><div class="ttname"><a href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#aa5d2b4417d4ad88098bb74ea75b54500">GetVehicleGearSetup</a></div><div class="ttdeci">static void GetVehicleGearSetup(const FVehicleNWTransmissionData &amp;Setup, PxVehicleGearsData &amp;PxSetup)</div><div class="ttdef"><b>定义</b> <a href="#l00148">WheeledVehicleMovementComponentNW.cpp:148</a></div></div>
<div class="ttc" id="aWheeledVehicleMovementComponentNW_8cpp_html_ab86c2f88f46c94457617779c19429cdb"><div class="ttname"><a href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#ab86c2f88f46c94457617779c19429cdb">BackwardsConvertCm2ToM2NW</a></div><div class="ttdeci">void BackwardsConvertCm2ToM2NW(float &amp;val, float defaultValue)</div><div class="ttdef"><b>定义</b> <a href="#l00354">WheeledVehicleMovementComponentNW.cpp:354</a></div></div>
<div class="ttc" id="aWheeledVehicleMovementComponentNW_8cpp_html_ac33b402e532a6f4d536e8675cfc56b09"><div class="ttname"><a href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#ac33b402e532a6f4d536e8675cfc56b09">SetupDriveHelper</a></div><div class="ttdeci">void SetupDriveHelper(const UWheeledVehicleMovementComponentNW *VehicleData, const PxVehicleWheelsSimData *PWheelsSimData, PxVehicleDriveSimDataNW &amp;DriveData)</div><div class="ttdef"><b>定义</b> <a href="#l00178">WheeledVehicleMovementComponentNW.cpp:178</a></div></div>
<div class="ttc" id="aWheeledVehicleMovementComponentNW_8cpp_html_ac806da6b225b0d47ea8ddb7610cc8e70"><div class="ttname"><a href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#ac806da6b225b0d47ea8ddb7610cc8e70">GetVehicleDifferentialNWSetup</a></div><div class="ttdeci">static void GetVehicleDifferentialNWSetup(const TArray&lt; FVehicleNWWheelDifferentialData &gt; &amp;Setup, PxVehicleDifferentialNWData &amp;PxSetup)</div><div class="ttdef"><b>定义</b> <a href="#l00105">WheeledVehicleMovementComponentNW.cpp:105</a></div></div>
<div class="ttc" id="aWheeledVehicleMovementComponentNW_8cpp_html_acffce682bc9ea728ec7e2c2fd2603543"><div class="ttname"><a href="../../d9/dc2/WheeledVehicleMovementComponentNW_8cpp.html#acffce682bc9ea728ec7e2c2fd2603543">GetVehicleAutoBoxSetup</a></div><div class="ttdeci">static void GetVehicleAutoBoxSetup(const FVehicleNWTransmissionData &amp;Setup, PxVehicleAutoBoxData &amp;PxSetup)</div><div class="ttdef"><b>定义</b> <a href="#l00160">WheeledVehicleMovementComponentNW.cpp:160</a></div></div>
<div class="ttc" id="aWheeledVehicleMovementComponentNW_8h_html"><div class="ttname"><a href="../../d0/d34/WheeledVehicleMovementComponentNW_8h.html">WheeledVehicleMovementComponentNW.h</a></div></div>
<div class="ttc" id="astructFVehicleNWEngineData_html"><div class="ttname"><a href="../../de/de4/structFVehicleNWEngineData.html">FVehicleNWEngineData</a></div><div class="ttdef"><b>定义</b> <a href="../../d0/d34/WheeledVehicleMovementComponentNW_8h_source.html#l00032">WheeledVehicleMovementComponentNW.h:33</a></div></div>
<div class="ttc" id="astructFVehicleNWEngineData_html_a7c7af0a90372f79d969508259f13f724"><div class="ttname"><a href="../../de/de4/structFVehicleNWEngineData.html#a7c7af0a90372f79d969508259f13f724">FVehicleNWEngineData::MOI</a></div><div class="ttdeci">float MOI</div><div class="ttdoc">Moment of inertia of the engine around the axis of rotation (Kgm^2).</div><div class="ttdef"><b>定义</b> <a href="../../d0/d34/WheeledVehicleMovementComponentNW_8h_source.html#l00046">WheeledVehicleMovementComponentNW.h:46</a></div></div>
<div class="ttc" id="astructFVehicleNWEngineData_html_a8662b0e878291ce55baee2f4a6da92e7"><div class="ttname"><a href="../../de/de4/structFVehicleNWEngineData.html#a8662b0e878291ce55baee2f4a6da92e7">FVehicleNWEngineData::MaxRPM</a></div><div class="ttdeci">float MaxRPM</div><div class="ttdoc">Maximum revolutions per minute of the engine</div><div class="ttdef"><b>定义</b> <a href="../../d0/d34/WheeledVehicleMovementComponentNW_8h_source.html#l00042">WheeledVehicleMovementComponentNW.h:42</a></div></div>
<div class="ttc" id="astructFVehicleNWEngineData_html_a8e4fc31f2d055a3b85fdf85e1cbde95c"><div class="ttname"><a href="../../de/de4/structFVehicleNWEngineData.html#a8e4fc31f2d055a3b85fdf85e1cbde95c">FVehicleNWEngineData::DampingRateFullThrottle</a></div><div class="ttdeci">float DampingRateFullThrottle</div><div class="ttdoc">Damping rate of engine when full throttle is applied (Kgm^2/s)</div><div class="ttdef"><b>定义</b> <a href="../../d0/d34/WheeledVehicleMovementComponentNW_8h_source.html#l00050">WheeledVehicleMovementComponentNW.h:50</a></div></div>
<div class="ttc" id="astructFVehicleNWEngineData_html_a981f29b1e71c72f980d0335e2fbc5bbd"><div class="ttname"><a href="../../de/de4/structFVehicleNWEngineData.html#a981f29b1e71c72f980d0335e2fbc5bbd">FVehicleNWEngineData::FindPeakTorque</a></div><div class="ttdeci">float FindPeakTorque() const</div><div class="ttdoc">Find the peak torque produced by the TorqueCurve</div><div class="ttdef"><b>定义</b> <a href="#l00113">WheeledVehicleMovementComponentNW.cpp:113</a></div></div>
<div class="ttc" id="astructFVehicleNWEngineData_html_ac22e7a52dce155b745efb48759a18225"><div class="ttname"><a href="../../de/de4/structFVehicleNWEngineData.html#ac22e7a52dce155b745efb48759a18225">FVehicleNWEngineData::DampingRateZeroThrottleClutchEngaged</a></div><div class="ttdeci">float DampingRateZeroThrottleClutchEngaged</div><div class="ttdoc">Damping rate of engine in at zero throttle when the clutch is engaged (Kgm^2/s)</div><div class="ttdef"><b>定义</b> <a href="../../d0/d34/WheeledVehicleMovementComponentNW_8h_source.html#l00054">WheeledVehicleMovementComponentNW.h:54</a></div></div>
<div class="ttc" id="astructFVehicleNWEngineData_html_ad5c4408177a986dd6a1605ba2aea7fb9"><div class="ttname"><a href="../../de/de4/structFVehicleNWEngineData.html#ad5c4408177a986dd6a1605ba2aea7fb9">FVehicleNWEngineData::TorqueCurve</a></div><div class="ttdeci">FRuntimeFloatCurve TorqueCurve</div><div class="ttdoc">Torque (Nm) at a given RPM</div><div class="ttdef"><b>定义</b> <a href="../../d0/d34/WheeledVehicleMovementComponentNW_8h_source.html#l00038">WheeledVehicleMovementComponentNW.h:38</a></div></div>
<div class="ttc" id="astructFVehicleNWEngineData_html_af3c6e9da67d8cfed1e478f2636fe9eaf"><div class="ttname"><a href="../../de/de4/structFVehicleNWEngineData.html#af3c6e9da67d8cfed1e478f2636fe9eaf">FVehicleNWEngineData::DampingRateZeroThrottleClutchDisengaged</a></div><div class="ttdeci">float DampingRateZeroThrottleClutchDisengaged</div><div class="ttdoc">Damping rate of engine in at zero throttle when the clutch is disengaged (in neutral gear) (Kgm^2/s)</div><div class="ttdef"><b>定义</b> <a href="../../d0/d34/WheeledVehicleMovementComponentNW_8h_source.html#l00058">WheeledVehicleMovementComponentNW.h:58</a></div></div>
<div class="ttc" id="astructFVehicleNWGearData_html"><div class="ttname"><a href="../../da/d31/structFVehicleNWGearData.html">FVehicleNWGearData</a></div><div class="ttdef"><b>定义</b> <a href="../../d0/d34/WheeledVehicleMovementComponentNW_8h_source.html#l00065">WheeledVehicleMovementComponentNW.h:66</a></div></div>
<div class="ttc" id="astructFVehicleNWGearData_html_a8f37e78f733f2dcc6cc15d6c69913d00"><div class="ttname"><a href="../../da/d31/structFVehicleNWGearData.html#a8f37e78f733f2dcc6cc15d6c69913d00">FVehicleNWGearData::Ratio</a></div><div class="ttdeci">float Ratio</div><div class="ttdoc">Determines the amount of torque multiplication</div><div class="ttdef"><b>定义</b> <a href="../../d0/d34/WheeledVehicleMovementComponentNW_8h_source.html#l00071">WheeledVehicleMovementComponentNW.h:71</a></div></div>
<div class="ttc" id="astructFVehicleNWGearData_html_adf09baf55006d7a9c3ea8f443f3eaf37"><div class="ttname"><a href="../../da/d31/structFVehicleNWGearData.html#adf09baf55006d7a9c3ea8f443f3eaf37">FVehicleNWGearData::DownRatio</a></div><div class="ttdeci">float DownRatio</div><div class="ttdoc">Value of engineRevs/maxEngineRevs that is low enough to gear down</div><div class="ttdef"><b>定义</b> <a href="../../d0/d34/WheeledVehicleMovementComponentNW_8h_source.html#l00075">WheeledVehicleMovementComponentNW.h:75</a></div></div>
<div class="ttc" id="astructFVehicleNWGearData_html_ae798c64d3cdbb31b6abfd6eec7a5ec09"><div class="ttname"><a href="../../da/d31/structFVehicleNWGearData.html#ae798c64d3cdbb31b6abfd6eec7a5ec09">FVehicleNWGearData::UpRatio</a></div><div class="ttdeci">float UpRatio</div><div class="ttdoc">Value of engineRevs/maxEngineRevs that is high enough to gear up</div><div class="ttdef"><b>定义</b> <a href="../../d0/d34/WheeledVehicleMovementComponentNW_8h_source.html#l00079">WheeledVehicleMovementComponentNW.h:79</a></div></div>
<div class="ttc" id="astructFVehicleNWTransmissionData_html"><div class="ttname"><a href="../../db/da1/structFVehicleNWTransmissionData.html">FVehicleNWTransmissionData</a></div><div class="ttdef"><b>定义</b> <a href="../../d0/d34/WheeledVehicleMovementComponentNW_8h_source.html#l00083">WheeledVehicleMovementComponentNW.h:84</a></div></div>
<div class="ttc" id="astructFVehicleNWTransmissionData_html_a5f17a7c9ed7f686d4d19f36e0a31909a"><div class="ttname"><a href="../../db/da1/structFVehicleNWTransmissionData.html#a5f17a7c9ed7f686d4d19f36e0a31909a">FVehicleNWTransmissionData::NeutralGearUpRatio</a></div><div class="ttdeci">float NeutralGearUpRatio</div><div class="ttdoc">Value of engineRevs/maxEngineRevs that is high enough to increment gear</div><div class="ttdef"><b>定义</b> <a href="../../d0/d34/WheeledVehicleMovementComponentNW_8h_source.html#l00112">WheeledVehicleMovementComponentNW.h:112</a></div></div>
<div class="ttc" id="astructFVehicleNWTransmissionData_html_a6b5ef510999369811c66884722607219"><div class="ttname"><a href="../../db/da1/structFVehicleNWTransmissionData.html#a6b5ef510999369811c66884722607219">FVehicleNWTransmissionData::GearSwitchTime</a></div><div class="ttdeci">float GearSwitchTime</div><div class="ttdoc">Time it takes to switch gears (seconds)</div><div class="ttdef"><b>定义</b> <a href="../../d0/d34/WheeledVehicleMovementComponentNW_8h_source.html#l00092">WheeledVehicleMovementComponentNW.h:92</a></div></div>
<div class="ttc" id="astructFVehicleNWTransmissionData_html_a9fe0561f1af34b0ea9ea56ae7f272561"><div class="ttname"><a href="../../db/da1/structFVehicleNWTransmissionData.html#a9fe0561f1af34b0ea9ea56ae7f272561">FVehicleNWTransmissionData::FinalRatio</a></div><div class="ttdeci">float FinalRatio</div><div class="ttdoc">The final gear ratio multiplies the transmission gear ratios.</div><div class="ttdef"><b>定义</b> <a href="../../d0/d34/WheeledVehicleMovementComponentNW_8h_source.html#l00100">WheeledVehicleMovementComponentNW.h:100</a></div></div>
<div class="ttc" id="astructFVehicleNWTransmissionData_html_aa89d362eb1e7224dc05b7928ab651135"><div class="ttname"><a href="../../db/da1/structFVehicleNWTransmissionData.html#aa89d362eb1e7224dc05b7928ab651135">FVehicleNWTransmissionData::ForwardGears</a></div><div class="ttdeci">TArray&lt; FVehicleNWGearData &gt; ForwardGears</div><div class="ttdoc">Forward gear ratios (up to 30)</div><div class="ttdef"><b>定义</b> <a href="../../d0/d34/WheeledVehicleMovementComponentNW_8h_source.html#l00104">WheeledVehicleMovementComponentNW.h:104</a></div></div>
<div class="ttc" id="astructFVehicleNWTransmissionData_html_abcd32b3eaa77483cea6bf95409a71dfe"><div class="ttname"><a href="../../db/da1/structFVehicleNWTransmissionData.html#abcd32b3eaa77483cea6bf95409a71dfe">FVehicleNWTransmissionData::ReverseGearRatio</a></div><div class="ttdeci">float ReverseGearRatio</div><div class="ttdoc">Reverse gear ratio</div><div class="ttdef"><b>定义</b> <a href="../../d0/d34/WheeledVehicleMovementComponentNW_8h_source.html#l00108">WheeledVehicleMovementComponentNW.h:108</a></div></div>
<div class="ttc" id="astructFVehicleNWTransmissionData_html_abe4054c6ca37cf25257886c208de5504"><div class="ttname"><a href="../../db/da1/structFVehicleNWTransmissionData.html#abe4054c6ca37cf25257886c208de5504">FVehicleNWTransmissionData::GearAutoBoxLatency</a></div><div class="ttdeci">float GearAutoBoxLatency</div><div class="ttdoc">Minimum time it takes the automatic transmission to initiate a gear change (seconds)</div><div class="ttdef"><b>定义</b> <a href="../../d0/d34/WheeledVehicleMovementComponentNW_8h_source.html#l00096">WheeledVehicleMovementComponentNW.h:96</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
制作者&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>

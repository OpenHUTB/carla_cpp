# LocalizationStage.cpp 文件详细描述

## 流程图

![image](https://github.com/OpenHUTB/carla_cpp/blob/dev/img/LocalizationStage.png)

## 实现方式

`LocalizationStage.cpp` 是一个用于车辆定位和路径规划的模块，它属于Carla模拟器的交通管理器（Traffic Manager）的一部分。该模块主要负责：

- 根据车辆的速度和位置更新路径点（waypoints）缓冲区。
- 处理车道变换。
- 导入自定义路径和路线。
- 确定车辆是否处于交叉路口入口。

## 实现原理

### 1. 车辆定位更新

- 首先，根据车辆的速度确定地平线长度（`horizon_length`），这是车辆在路径规划中考虑的最远距离。
- 检查车辆是否在缓冲区中，如果不在，则初始化。
- 清除与车辆位置过远的路径点。

### 2. 车道变换

- 根据车辆的速度和配置参数，决定是否需要进行车道变换。
- 检查相邻车道是否有足够空间进行车道变换。

### 3. 路径点缓冲区管理

- 维护一个路径点缓冲区，用于存储车辆前方的路径点。
- 根据车辆的速度和位置动态更新缓冲区中的路径点。

### 4. 交叉路口处理

- 确定车辆是否接近交叉路口，并相应地调整路径点。

### 5. 自定义路径和路线导入

- 允许用户导入自定义路径或路线，这些路径和路线将被整合到车辆的路径规划中。


